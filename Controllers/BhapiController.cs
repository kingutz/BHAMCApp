using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Threading.Tasks;
using BHAMCApp.Data;
using BHAMCApp.Models;
using ClosedXML.Excel;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using Microsoft.EntityFrameworkCore;

namespace BHAMCApp.Controllers
{
    [Route("api/bhdata")]
    [ApiController]
    public class BhapiController : ControllerBase
    {
        private readonly ApplicationDbContext _context;

        public BhapiController(ApplicationDbContext context)
        {
            _context = context;
        }
        public async Task<ActionResult> Exdoc()

        {
            List<Bhamc> bhamcs = new List<Bhamc>();
            bhamcs = await _context.Bhamc.ToListAsync();
            using (var workbook = new XLWorkbook())
            {
                var worksheet = workbook.Worksheets.Add("bhamcs");
                var currentRow = 1;

                worksheet.Cell(currentRow, 1).Value = "ID";
                worksheet.Cell(currentRow, 2).Value = "QuestionnaireNo";
                worksheet.Cell(currentRow, 3).Value = "AntenatalCare";
                worksheet.Cell(currentRow, 4).Value = "GestationalAge";
                worksheet.Cell(currentRow, 5).Value = "DateMenstruation";
                worksheet.Cell(currentRow, 6).Value = "ExpectedDate";
                worksheet.Cell(currentRow, 7).Value = "HospitalName";
                worksheet.Cell(currentRow, 8).Value = "PostNatalCare";
                worksheet.Cell(currentRow, 9).Value = "InterviewerName";
                worksheet.Cell(currentRow, 10).Value = "InterviewDate";
                worksheet.Cell(currentRow, 11).Value = "Q1";
                worksheet.Cell(currentRow, 12).Value = "Q2";
                worksheet.Cell(currentRow, 13).Value = "Q3";
                worksheet.Cell(currentRow, 14).Value = "OthersQ3";
                worksheet.Cell(currentRow, 15).Value = "Q4";
                worksheet.Cell(currentRow, 16).Value = "OthersQ4";
                worksheet.Cell(currentRow, 17).Value = "Q5";
                worksheet.Cell(currentRow, 18).Value = "Q6";
                worksheet.Cell(currentRow, 19).Value = "Q7";
                worksheet.Cell(currentRow, 20).Value = "Q8";
                worksheet.Cell(currentRow, 21).Value = "Q9";
                worksheet.Cell(currentRow, 22).Value = "Q10";
                worksheet.Cell(currentRow, 23).Value = "OthersQ10";
                worksheet.Cell(currentRow, 24).Value = "Q11";
                worksheet.Cell(currentRow, 25).Value = "Q12_1";
                worksheet.Cell(currentRow, 26).Value = "Q12_2";
                worksheet.Cell(currentRow, 27).Value = "Q12_3";
                worksheet.Cell(currentRow, 28).Value = "Q12_4";
                worksheet.Cell(currentRow, 29).Value = "Q12_5";
                worksheet.Cell(currentRow, 30).Value = "Q12_6";
                worksheet.Cell(currentRow, 31).Value = "Q12_7";
                worksheet.Cell(currentRow, 32).Value = "Q13";
                worksheet.Cell(currentRow, 33).Value = "OthersQ13";
                worksheet.Cell(currentRow, 34).Value = "Q14";
                worksheet.Cell(currentRow, 35).Value = "Q15";
                worksheet.Cell(currentRow, 36).Value = "OthersQ15";
                worksheet.Cell(currentRow, 37).Value = "Q16";
                worksheet.Cell(currentRow, 38).Value = "Q17";
                worksheet.Cell(currentRow, 39).Value = "Q18";
                worksheet.Cell(currentRow, 40).Value = "OthersQ18";
                worksheet.Cell(currentRow, 41).Value = "Q19";
                worksheet.Cell(currentRow, 42).Value = "Q20";
                worksheet.Cell(currentRow, 43).Value = "OthersQ20";
                worksheet.Cell(currentRow, 44).Value = "Q21";
                worksheet.Cell(currentRow, 45).Value = "Q22_1";
                worksheet.Cell(currentRow, 46).Value = "Q22_2";
                worksheet.Cell(currentRow, 47).Value = "Q22_3";
                worksheet.Cell(currentRow, 48).Value = "Q22_4";
                worksheet.Cell(currentRow, 49).Value = "OthersQ22_4";
                worksheet.Cell(currentRow, 50).Value = "Q23";
                worksheet.Cell(currentRow, 51).Value = "Q24";
                worksheet.Cell(currentRow, 52).Value = "Q25";
                worksheet.Cell(currentRow, 53).Value = "Q26";
                worksheet.Cell(currentRow, 54).Value = "Q27";
                worksheet.Cell(currentRow, 55).Value = "Q28";
                worksheet.Cell(currentRow, 56).Value = "Q29";
                worksheet.Cell(currentRow, 57).Value = "Q30";
                worksheet.Cell(currentRow, 58).Value = "Q31";
                worksheet.Cell(currentRow, 59).Value = "Q32";
                worksheet.Cell(currentRow, 60).Value = "Q32_1";
                worksheet.Cell(currentRow, 61).Value = "Q33";
                worksheet.Cell(currentRow, 62).Value = "Q34";
                worksheet.Cell(currentRow, 63).Value = "Q35";
                worksheet.Cell(currentRow, 64).Value = "OthersQ35";
                worksheet.Cell(currentRow, 65).Value = "Q36";
                worksheet.Cell(currentRow, 66).Value = "OthersQ36";
                worksheet.Cell(currentRow, 67).Value = "Q37";
                worksheet.Cell(currentRow, 68).Value = "Q38";
                worksheet.Cell(currentRow, 69).Value = "Q39";
                worksheet.Cell(currentRow, 70).Value = "Q40";
                worksheet.Cell(currentRow, 71).Value = "Q41";
                worksheet.Cell(currentRow, 72).Value = "Q42";
                worksheet.Cell(currentRow, 73).Value = "Q43_1";
                worksheet.Cell(currentRow, 74).Value = "Q43_2";
                worksheet.Cell(currentRow, 75).Value = "Q43_3";
                worksheet.Cell(currentRow, 76).Value = "Q43_4";
                worksheet.Cell(currentRow, 77).Value = "Q43_5";
                worksheet.Cell(currentRow, 78).Value = "Q43_6";
                worksheet.Cell(currentRow, 79).Value = "Q44";
                worksheet.Cell(currentRow, 80).Value = "Q45";
                worksheet.Cell(currentRow, 81).Value = "Q46";
                worksheet.Cell(currentRow, 82).Value = "Q47";
                worksheet.Cell(currentRow, 83).Value = "Q48";
                worksheet.Cell(currentRow, 84).Value = "Q49";
                worksheet.Cell(currentRow, 85).Value = "Q50";
                worksheet.Cell(currentRow, 86).Value = "Q51";
                worksheet.Cell(currentRow, 87).Value = "Q52";
                worksheet.Cell(currentRow, 88).Value = "Q53";
                worksheet.Cell(currentRow, 89).Value = "Q54";
                worksheet.Cell(currentRow, 90).Value = "Q54_1";
                worksheet.Cell(currentRow, 91).Value = "Q54_2";
                worksheet.Cell(currentRow, 92).Value = "Q54_3";
                worksheet.Cell(currentRow, 93).Value = "Q54_4";
                worksheet.Cell(currentRow, 94).Value = "Q55";
                worksheet.Cell(currentRow, 95).Value = "Q56";
                worksheet.Cell(currentRow, 96).Value = "Q56_1";
                worksheet.Cell(currentRow, 97).Value = "Q56_2";
                worksheet.Cell(currentRow, 98).Value = "Q56_3";
                worksheet.Cell(currentRow, 99).Value = "Q56_4";
                worksheet.Cell(currentRow, 100).Value = "Q56_5";
                worksheet.Cell(currentRow, 101).Value = "OthersQ56";
                worksheet.Cell(currentRow, 102).Value = "Q58_1";
                worksheet.Cell(currentRow, 103).Value = "Q58_2";
                worksheet.Cell(currentRow, 104).Value = "Q58_3";
                worksheet.Cell(currentRow, 105).Value = "Q58_4";
                worksheet.Cell(currentRow, 106).Value = "Q59_1";
                worksheet.Cell(currentRow, 107).Value = "Q59_2";
                worksheet.Cell(currentRow, 108).Value = "Q59_3";
                worksheet.Cell(currentRow, 109).Value = "Q59_4";
                worksheet.Cell(currentRow, 110).Value = "Q59_5";
                worksheet.Cell(currentRow, 111).Value = "Q59_6";
                worksheet.Cell(currentRow, 112).Value = "Q60";
                worksheet.Cell(currentRow, 113).Value = "Q60_1";
                worksheet.Cell(currentRow, 114).Value = "Q60_2";
                worksheet.Cell(currentRow, 115).Value = "Q60_3";
                worksheet.Cell(currentRow, 116).Value = "Q61_1";
                worksheet.Cell(currentRow, 117).Value = "Q61_2";
                worksheet.Cell(currentRow, 118).Value = "Q61_3";
                worksheet.Cell(currentRow, 119).Value = "Q61_4";
                worksheet.Cell(currentRow, 120).Value = "Q61_5";
                worksheet.Cell(currentRow, 121).Value = "Q61_6";
                worksheet.Cell(currentRow, 122).Value = "Q62";
                worksheet.Cell(currentRow, 123).Value = "Q63";
                worksheet.Cell(currentRow, 124).Value = "Q64_1";
                worksheet.Cell(currentRow, 125).Value = "Q64_2";
                worksheet.Cell(currentRow, 126).Value = "Q64_3";
                worksheet.Cell(currentRow, 127).Value = "Q64_4";
                worksheet.Cell(currentRow, 128).Value = "Q64_5";
                worksheet.Cell(currentRow, 129).Value = "Q65";
                worksheet.Cell(currentRow, 130).Value = "Q66";
                worksheet.Cell(currentRow, 131).Value = "Q67";
                worksheet.Cell(currentRow, 132).Value = "OthersQ67";
                worksheet.Cell(currentRow, 133).Value = "Q68";
                worksheet.Cell(currentRow, 134).Value = "Q68Yes";
                worksheet.Cell(currentRow, 135).Value = "Q69";
                worksheet.Cell(currentRow, 136).Value = "Q70_1";
                worksheet.Cell(currentRow, 137).Value = "Q70_2";
                worksheet.Cell(currentRow, 138).Value = "Q70_3";
                worksheet.Cell(currentRow, 139).Value = "Q70_4";
                worksheet.Cell(currentRow, 140).Value = "OthersQ70_4";
                worksheet.Cell(currentRow, 141).Value = "Q71";
                worksheet.Cell(currentRow, 142).Value = "Q71_1";
                worksheet.Cell(currentRow, 143).Value = "Q72";
                worksheet.Cell(currentRow, 144).Value = "Q73";
                worksheet.Cell(currentRow, 145).Value = "Q74";
                worksheet.Cell(currentRow, 146).Value = "Q75";
                worksheet.Cell(currentRow, 147).Value = "Q76";
                worksheet.Cell(currentRow, 148).Value = "Q77";
                worksheet.Cell(currentRow, 149).Value = "Q78";
                worksheet.Cell(currentRow, 150).Value = "Q79";
                worksheet.Cell(currentRow, 151).Value = "Q80";
                worksheet.Cell(currentRow, 152).Value = "Q81_1";
                worksheet.Cell(currentRow, 153).Value = "Q81_2";
                worksheet.Cell(currentRow, 154).Value = "Q81_3";
                worksheet.Cell(currentRow, 155).Value = "Q81_4";
                worksheet.Cell(currentRow, 156).Value = "Q81_5";
                worksheet.Cell(currentRow, 157).Value = "Q81_6";
                worksheet.Cell(currentRow, 158).Value = "Q82_1";
                worksheet.Cell(currentRow, 159).Value = "Q82_2";
                worksheet.Cell(currentRow, 160).Value = "Q82_3";
                worksheet.Cell(currentRow, 161).Value = "Q82_4";
                worksheet.Cell(currentRow, 162).Value = "Q82_5";
                worksheet.Cell(currentRow, 163).Value = "Q83";
                worksheet.Cell(currentRow, 164).Value = "Q84";
                worksheet.Cell(currentRow, 165).Value = "Q85";
                worksheet.Cell(currentRow, 166).Value = "Q86";
                worksheet.Cell(currentRow, 167).Value = "Q87";
                worksheet.Cell(currentRow, 168).Value = "Q88";
                worksheet.Cell(currentRow, 169).Value = "Q89";
                worksheet.Cell(currentRow, 170).Value = "Q90";
                worksheet.Cell(currentRow, 171).Value = "OthersQ90";
                worksheet.Cell(currentRow, 172).Value = "Q91";
                worksheet.Cell(currentRow, 173).Value = "Q92";
                worksheet.Cell(currentRow, 174).Value = "OthersQ92";
                worksheet.Cell(currentRow, 175).Value = "Q93";
                worksheet.Cell(currentRow, 176).Value = "Q94";
                worksheet.Cell(currentRow, 177).Value = "Q95";
                worksheet.Cell(currentRow, 178).Value = "Q96";
                worksheet.Cell(currentRow, 179).Value = "Q97";
                worksheet.Cell(currentRow, 180).Value = "Q98_1";
                worksheet.Cell(currentRow, 181).Value = "Q98_2";
                worksheet.Cell(currentRow, 182).Value = "Q98_3";
                worksheet.Cell(currentRow, 183).Value = "Q98_4";
                worksheet.Cell(currentRow, 184).Value = "Q98_5";
                worksheet.Cell(currentRow, 185).Value = "Q98_6";
                worksheet.Cell(currentRow, 186).Value = "Q99_1";
                worksheet.Cell(currentRow, 187).Value = "Q99_2";
                worksheet.Cell(currentRow, 188).Value = "Q99_3";
                worksheet.Cell(currentRow, 189).Value = "Q99_4";
                worksheet.Cell(currentRow, 190).Value = "Q99_5";
                worksheet.Cell(currentRow, 191).Value = "Q100_1_1";
                //worksheet.Cell(currentRow, 192).Value = "Q100_2_1";
                //worksheet.Cell(currentRow, 193).Value = "Q100_2_2";
                //worksheet.Cell(currentRow, 194).Value = "Q100_2_3";
                worksheet.Cell(currentRow, 192).Value = "QEA100";
                //worksheet.Cell(currentRow, 195).Value = "Q100_3_1";
                //worksheet.Cell(currentRow, 196).Value = "Q100_3_2";
                //worksheet.Cell(currentRow, 197).Value = "Q100_3_3";
                //worksheet.Cell(currentRow, 198).Value = "Q100_3_4";
                worksheet.Cell(currentRow, 193).Value = "QEC100";
                //worksheet.Cell(currentRow, 199).Value = "Q100_4_1";
                //worksheet.Cell(currentRow, 200).Value = "Q100_4_2";
                //worksheet.Cell(currentRow, 201).Value = "Q100_4_3";
                //worksheet.Cell(currentRow, 202).Value = "Q100_4_4";
                //worksheet.Cell(currentRow, 203).Value = "Q100_4_5";
                worksheet.Cell(currentRow, 194).Value = "QECO100";
                worksheet.Cell(currentRow, 195).Value = "Q100_5_1";
                worksheet.Cell(currentRow, 196).Value = "Q100_6_1";
                //worksheet.Cell(currentRow, 206).Value = "Q101_1";
                //worksheet.Cell(currentRow, 207).Value = "Q101_2";
                //worksheet.Cell(currentRow, 208).Value = "Q101_3";
                worksheet.Cell(currentRow, 197).Value = "QECOO100";
                worksheet.Cell(currentRow, 198).Value = "Q102";
                worksheet.Cell(currentRow, 199).Value = "Q103";
                worksheet.Cell(currentRow, 200).Value = "CreatedDate";



                foreach (var item in bhamcs)
                {
                    currentRow++;
                    worksheet.Cell(currentRow, 1).Value = item.ID;
                    worksheet.Cell(currentRow, 2).Value = item.QuestionnaireNo;
                    worksheet.Cell(currentRow, 3).Value = item.AntenatalCare;
                    worksheet.Cell(currentRow, 4).Value = item.GestationalAge;
                    worksheet.Cell(currentRow, 5).Value = item.DateMenstruation;
                    worksheet.Cell(currentRow, 6).Value = item.ExpectedDate;
                    worksheet.Cell(currentRow, 7).Value = item.HospitalName;
                    worksheet.Cell(currentRow, 8).Value = item.PostNatalCare;
                    worksheet.Cell(currentRow, 9).Value = item.InterviewerName;
                    worksheet.Cell(currentRow, 10).Value = item.InterviewDate;
                    worksheet.Cell(currentRow, 11).Value = item.Q1;
                    worksheet.Cell(currentRow, 12).Value = item.Q2;
                    worksheet.Cell(currentRow, 13).Value = item.Q3;
                    worksheet.Cell(currentRow, 14).Value = item.OthersQ3;
                    worksheet.Cell(currentRow, 15).Value = item.Q4;
                    worksheet.Cell(currentRow, 16).Value = item.OthersQ4;
                    worksheet.Cell(currentRow, 17).Value = item.Q5;
                    worksheet.Cell(currentRow, 18).Value = item.Q6;
                    worksheet.Cell(currentRow, 19).Value = item.Q7;
                    worksheet.Cell(currentRow, 20).Value = item.Q8;
                    worksheet.Cell(currentRow, 21).Value = item.Q9;
                    worksheet.Cell(currentRow, 22).Value = item.Q10;
                    worksheet.Cell(currentRow, 23).Value = item.OthersQ10;
                    worksheet.Cell(currentRow, 24).Value = item.Q11;
                    worksheet.Cell(currentRow, 25).Value = item.Q12_1;
                    worksheet.Cell(currentRow, 26).Value = item.Q12_2;
                    worksheet.Cell(currentRow, 27).Value = item.Q12_3;
                    worksheet.Cell(currentRow, 28).Value = item.Q12_4;
                    worksheet.Cell(currentRow, 29).Value = item.Q12_5;
                    worksheet.Cell(currentRow, 30).Value = item.Q12_6;
                    worksheet.Cell(currentRow, 31).Value = item.Q12_7;
                    worksheet.Cell(currentRow, 32).Value = item.Q13;
                    worksheet.Cell(currentRow, 33).Value = item.OthersQ13;
                    worksheet.Cell(currentRow, 34).Value = item.Q14;
                    worksheet.Cell(currentRow, 35).Value = item.Q15;
                    worksheet.Cell(currentRow, 36).Value = item.OthersQ15;
                    worksheet.Cell(currentRow, 37).Value = item.Q16;
                    worksheet.Cell(currentRow, 38).Value = item.Q17;
                    worksheet.Cell(currentRow, 39).Value = item.Q18;
                    worksheet.Cell(currentRow, 40).Value = item.OthersQ18;
                    worksheet.Cell(currentRow, 41).Value = item.Q19;
                    worksheet.Cell(currentRow, 42).Value = item.Q20;
                    worksheet.Cell(currentRow, 43).Value = item.OthersQ20;
                    worksheet.Cell(currentRow, 44).Value = item.Q21;
                    worksheet.Cell(currentRow, 45).Value = item.Q22_1;
                    worksheet.Cell(currentRow, 46).Value = item.Q22_2;
                    worksheet.Cell(currentRow, 47).Value = item.Q22_3;
                    worksheet.Cell(currentRow, 48).Value = item.Q22_4;
                    worksheet.Cell(currentRow, 49).Value = item.OthersQ22_4;
                    worksheet.Cell(currentRow, 50).Value = item.Q23;
                    worksheet.Cell(currentRow, 51).Value = item.Q24;
                    worksheet.Cell(currentRow, 52).Value = item.Q25;
                    worksheet.Cell(currentRow, 53).Value = item.Q26;
                    worksheet.Cell(currentRow, 54).Value = item.Q27;
                    worksheet.Cell(currentRow, 55).Value = item.Q28;
                    worksheet.Cell(currentRow, 56).Value = item.Q29;
                    worksheet.Cell(currentRow, 57).Value = item.Q30;
                    worksheet.Cell(currentRow, 58).Value = item.Q31;
                    worksheet.Cell(currentRow, 59).Value = item.Q32;
                    worksheet.Cell(currentRow, 60).Value = item.Q32_1;
                    worksheet.Cell(currentRow, 61).Value = item.Q33;
                    worksheet.Cell(currentRow, 62).Value = item.Q34;
                    worksheet.Cell(currentRow, 63).Value = item.Q35;
                    worksheet.Cell(currentRow, 64).Value = item.OthersQ35;
                    worksheet.Cell(currentRow, 65).Value = item.Q36;
                    worksheet.Cell(currentRow, 66).Value = item.OthersQ36;
                    worksheet.Cell(currentRow, 67).Value = item.Q37;
                    worksheet.Cell(currentRow, 68).Value = item.Q38;
                    worksheet.Cell(currentRow, 69).Value = item.Q39;
                    worksheet.Cell(currentRow, 70).Value = item.Q40;
                    worksheet.Cell(currentRow, 71).Value = item.Q41;
                    worksheet.Cell(currentRow, 72).Value = item.Q42;
                    worksheet.Cell(currentRow, 73).Value = item.Q43_1;
                    worksheet.Cell(currentRow, 74).Value = item.Q43_2;
                    worksheet.Cell(currentRow, 75).Value = item.Q43_3;
                    worksheet.Cell(currentRow, 76).Value = item.Q43_4;
                    worksheet.Cell(currentRow, 77).Value = item.Q43_5;
                    worksheet.Cell(currentRow, 78).Value = item.Q43_6;
                    worksheet.Cell(currentRow, 79).Value = item.Q44;
                    worksheet.Cell(currentRow, 80).Value = item.Q45;
                    worksheet.Cell(currentRow, 81).Value = item.Q46;
                    worksheet.Cell(currentRow, 82).Value = item.Q47;
                    worksheet.Cell(currentRow, 83).Value = item.Q48;
                    worksheet.Cell(currentRow, 84).Value = item.Q49;
                    worksheet.Cell(currentRow, 85).Value = item.Q50;
                    worksheet.Cell(currentRow, 86).Value = item.Q51;
                    worksheet.Cell(currentRow, 87).Value = item.Q52;
                    worksheet.Cell(currentRow, 88).Value = item.Q53;
                    worksheet.Cell(currentRow, 89).Value = item.Q54;
                    worksheet.Cell(currentRow, 90).Value = item.Q54_1;
                    worksheet.Cell(currentRow, 91).Value = item.Q54_2;
                    worksheet.Cell(currentRow, 92).Value = item.Q54_3;
                    worksheet.Cell(currentRow, 93).Value = item.Q54_4;
                    worksheet.Cell(currentRow, 94).Value = item.Q55;
                    worksheet.Cell(currentRow, 95).Value = item.Q56;
                    worksheet.Cell(currentRow, 96).Value = item.Q56_1;
                    worksheet.Cell(currentRow, 97).Value = item.Q56_2;
                    worksheet.Cell(currentRow, 98).Value = item.Q56_3;
                    worksheet.Cell(currentRow, 99).Value = item.Q56_4;
                    worksheet.Cell(currentRow, 100).Value = item.Q56_5;
                    worksheet.Cell(currentRow, 101).Value = item.OthersQ56;
                    worksheet.Cell(currentRow, 102).Value = item.Q58_1;
                    worksheet.Cell(currentRow, 103).Value = item.Q58_2;
                    worksheet.Cell(currentRow, 104).Value = item.Q58_3;
                    worksheet.Cell(currentRow, 105).Value = item.Q58_4;
                    worksheet.Cell(currentRow, 106).Value = item.Q59_1;
                    worksheet.Cell(currentRow, 107).Value = item.Q59_2;
                    worksheet.Cell(currentRow, 108).Value = item.Q59_3;
                    worksheet.Cell(currentRow, 109).Value = item.Q59_4;
                    worksheet.Cell(currentRow, 110).Value = item.Q59_5;
                    worksheet.Cell(currentRow, 111).Value = item.Q59_6;
                    worksheet.Cell(currentRow, 112).Value = item.Q60;
                    worksheet.Cell(currentRow, 113).Value = item.Q60_1;
                    worksheet.Cell(currentRow, 114).Value = item.Q60_2;
                    worksheet.Cell(currentRow, 115).Value = item.Q60_3;
                    worksheet.Cell(currentRow, 116).Value = item.Q61_1;
                    worksheet.Cell(currentRow, 117).Value = item.Q61_2;
                    worksheet.Cell(currentRow, 118).Value = item.Q61_3;
                    worksheet.Cell(currentRow, 119).Value = item.Q61_4;
                    worksheet.Cell(currentRow, 120).Value = item.Q61_5;
                    worksheet.Cell(currentRow, 121).Value = item.Q61_6;
                    worksheet.Cell(currentRow, 122).Value = item.Q62;
                    worksheet.Cell(currentRow, 123).Value = item.Q63;
                    worksheet.Cell(currentRow, 124).Value = item.Q64_1;
                    worksheet.Cell(currentRow, 125).Value = item.Q64_2;
                    worksheet.Cell(currentRow, 126).Value = item.Q64_3;
                    worksheet.Cell(currentRow, 127).Value = item.Q64_4;
                    worksheet.Cell(currentRow, 128).Value = item.Q64_5;
                    worksheet.Cell(currentRow, 129).Value = item.Q65;
                    worksheet.Cell(currentRow, 130).Value = item.Q66;
                    worksheet.Cell(currentRow, 131).Value = item.Q67;
                    worksheet.Cell(currentRow, 132).Value = item.OthersQ67;
                    worksheet.Cell(currentRow, 133).Value = item.Q68;
                    worksheet.Cell(currentRow, 134).Value = item.Q68Yes;
                    worksheet.Cell(currentRow, 135).Value = item.Q69;
                    worksheet.Cell(currentRow, 136).Value = item.Q70_1;
                    worksheet.Cell(currentRow, 137).Value = item.Q70_2;
                    worksheet.Cell(currentRow, 138).Value = item.Q70_3;
                    worksheet.Cell(currentRow, 139).Value = item.Q70_4;
                    worksheet.Cell(currentRow, 140).Value = item.OthersQ70_4;
                    worksheet.Cell(currentRow, 141).Value = item.Q71;
                    worksheet.Cell(currentRow, 142).Value = item.Q71_1;
                    worksheet.Cell(currentRow, 143).Value = item.Q72;
                    worksheet.Cell(currentRow, 144).Value = item.Q73;
                    worksheet.Cell(currentRow, 145).Value = item.Q74;
                    worksheet.Cell(currentRow, 146).Value = item.Q75;
                    worksheet.Cell(currentRow, 147).Value = item.Q76;
                    worksheet.Cell(currentRow, 148).Value = item.Q77;
                    worksheet.Cell(currentRow, 149).Value = item.Q78;
                    worksheet.Cell(currentRow, 150).Value = item.Q79;
                    worksheet.Cell(currentRow, 151).Value = item.Q80;
                    worksheet.Cell(currentRow, 152).Value = item.Q81_1;
                    worksheet.Cell(currentRow, 153).Value = item.Q81_2;
                    worksheet.Cell(currentRow, 154).Value = item.Q81_3;
                    worksheet.Cell(currentRow, 155).Value = item.Q81_4;
                    worksheet.Cell(currentRow, 156).Value = item.Q81_5;
                    worksheet.Cell(currentRow, 157).Value = item.Q81_6;
                    worksheet.Cell(currentRow, 158).Value = item.Q82_1;
                    worksheet.Cell(currentRow, 159).Value = item.Q82_2;
                    worksheet.Cell(currentRow, 160).Value = item.Q82_3;
                    worksheet.Cell(currentRow, 161).Value = item.Q82_4;
                    worksheet.Cell(currentRow, 162).Value = item.Q82_5;
                    worksheet.Cell(currentRow, 163).Value = item.Q83;
                    worksheet.Cell(currentRow, 164).Value = item.Q84;
                    worksheet.Cell(currentRow, 165).Value = item.Q85;
                    worksheet.Cell(currentRow, 166).Value = item.Q86;
                    worksheet.Cell(currentRow, 167).Value = item.Q87;
                    worksheet.Cell(currentRow, 168).Value = item.Q88;
                    worksheet.Cell(currentRow, 169).Value = item.Q89;
                    worksheet.Cell(currentRow, 170).Value = item.Q90;
                    worksheet.Cell(currentRow, 171).Value = item.OthersQ90;
                    worksheet.Cell(currentRow, 172).Value = item.Q91;
                    worksheet.Cell(currentRow, 173).Value = item.Q92;
                    worksheet.Cell(currentRow, 174).Value = item.OthersQ92;
                    worksheet.Cell(currentRow, 175).Value = item.Q93;
                    worksheet.Cell(currentRow, 176).Value = item.Q94;
                    worksheet.Cell(currentRow, 177).Value = item.Q95;
                    worksheet.Cell(currentRow, 178).Value = item.Q96;
                    worksheet.Cell(currentRow, 179).Value = item.Q97;
                    worksheet.Cell(currentRow, 180).Value = item.Q98_1;
                    worksheet.Cell(currentRow, 181).Value = item.Q98_2;
                    worksheet.Cell(currentRow, 182).Value = item.Q98_3;
                    worksheet.Cell(currentRow, 183).Value = item.Q98_4;
                    worksheet.Cell(currentRow, 184).Value = item.Q98_5;
                    worksheet.Cell(currentRow, 185).Value = item.Q98_6;
                    worksheet.Cell(currentRow, 186).Value = item.Q99_1;
                    worksheet.Cell(currentRow, 187).Value = item.Q99_2;
                    worksheet.Cell(currentRow, 188).Value = item.Q99_3;
                    worksheet.Cell(currentRow, 189).Value = item.Q99_4;
                    worksheet.Cell(currentRow, 190).Value = item.Q99_5;
                    worksheet.Cell(currentRow, 191).Value = item.Q100_1_1;
                    //worksheet.Cell(currentRow, 192).Value = item.Q100_2_1;
                    //worksheet.Cell(currentRow, 193).Value = item.Q100_2_2;
                    //worksheet.Cell(currentRow, 194).Value = item.Q100_2_3;
                    worksheet.Cell(currentRow, 192).Value = item.QEA100;
                    //worksheet.Cell(currentRow, 195).Value = item.Q100_3_1;
                    //worksheet.Cell(currentRow, 196).Value = item.Q100_3_2;
                    //worksheet.Cell(currentRow, 197).Value = item.Q100_3_3;
                    //worksheet.Cell(currentRow, 198).Value = item.Q100_3_4;
                    worksheet.Cell(currentRow, 193).Value = item.QEC100;
                    //worksheet.Cell(currentRow, 199).Value = item.Q100_4_1;
                    //worksheet.Cell(currentRow, 200).Value = item.Q100_4_2;
                    //worksheet.Cell(currentRow, 201).Value = item.Q100_4_3;
                    //worksheet.Cell(currentRow, 202).Value = item.Q100_4_4;
                    //worksheet.Cell(currentRow, 203).Value = item.Q100_4_5;
                    worksheet.Cell(currentRow, 194).Value = item.QECO100;
                    worksheet.Cell(currentRow, 195).Value = item.Q100_5_1;
                    worksheet.Cell(currentRow, 196).Value = item.Q100_6_1;
                    //worksheet.Cell(currentRow, 206).Value = item.Q101_1;
                    //worksheet.Cell(currentRow, 207).Value = item.Q101_2;
                    //worksheet.Cell(currentRow, 208).Value = item.Q101_3;
                    worksheet.Cell(currentRow, 197).Value = item.QECOO100;
                    worksheet.Cell(currentRow, 198).Value = item.Q102;
                    worksheet.Cell(currentRow, 199).Value = item.Q103;
                    worksheet.Cell(currentRow, 200).Value = item.CreatedDate;

                }
                using (var stream = new MemoryStream())
                {
                    workbook.SaveAs(stream);
                    var content = stream.ToArray();
                    return File(content, "application/vnd.openxlformats-officedocument.spreadsheetml.sheet"
                        , "datanfo.xlsx");
                }
            }
        }

    }
}
